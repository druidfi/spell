{
  "name": "druidfi/spell",
  "description": "Spell to create a new Drupal 8 project based on druidfi/d8-template",
  "type": "project",
  "license": "MIT",
  "homepage": "https://github.com/druidfi/spell",
  "authors": [
    {
      "name": "Druid.fi",
      "email": "info@druid.fi"
    }
  ],
  "minimum-stability": "dev",
  "prefer-stable": true,
  "require": {
    "composer/installers": "^1.4",
    "cweagans/composer-patches": "^1.6",
    "drupal-composer/drupal-scaffold": "^2.3",
    "drupal/admin_toolbar": "^1.22",
    "drupal/config_installer": "^1.5",
    "drupal/core": "^8.5.1",
    "drupal/gdpr": "^1.0@alpha",
    "drupal/pathauto": "^1.1",
    "drupal/swiftmailer": "^1.0@beta",
    "drupal/system_status": "^2.6",
    "drush/drush": "^8.1.16",
    "wikimedia/composer-merge-plugin": "~1.0"
  },
  "require-dev": {
    "druidfi/amazeeio-scripts": "1.0.0",
    "drupal/coder": "^8.2.12",
    "drupal/console": "^1.0.2",
    "drupal/drupal-extension": "~3.3",
    "phpunit/phpunit": "~5.7"
  },
  "conflict": {
    "drupal/drupal": "*"
  },
  "config": {
    "platform": {
      "php": "7.1"
    },
    "sort-packages": true
  },
  "extra": {
    "merge-plugin": {
      "include": [
        "public/modules/custom/*/composer.json"
      ]
    },
    "installer-paths": {
      "public/core": ["type:drupal-core"],
      "public/libraries/{$name}": ["type:drupal-library"],
      "public/modules/contrib/{$name}": ["type:drupal-module"],
      "public/modules/custom/{$name}": ["type:drupal-module-custom"],
      "public/profiles/{$name}": ["type:drupal-profile"],
      "public/themes/contrib/{$name}": ["type:drupal-theme"],
      "public/themes/custom/{$name}": ["type:drupal-theme-custom"],
      "drush/{$name}": ["type:drupal-drush"]
    }
  },
  "repositories": [
    {
      "type": "composer",
      "url": "https://packages.drupal.org/8"
    }
  ],
  "scripts": {
    "post-create-project-cmd": [
      "rsync -av vendor/druidfi/amazeeio-scripts/dist/ .",
      "mv README.project.md README.md",
      "git init && git add ."
    ],
    "build-dev": [
      "build-dev.sh"
    ],
    "build-dev-actions": [
      "npm install --engine-strict true",
      "@composer install --prefer-dist --no-suggest --ignore-platform-reqs --ansi",
      "cp -R ./vendor/drupal/coder/coder_sniffer/Drupal ./vendor/squizlabs/php_codesniffer/CodeSniffer/Standards/Drupal",
      "cp -R ./vendor/drupal/coder/coder_sniffer/DrupalPractice ./vendor/squizlabs/php_codesniffer/CodeSniffer/Standards/DrupalPractice",
      "@copy-configuration",
      "cp conf/development.services.yml public/sites/default/development.services.yml",
      "cp conf/development.settings.php public/sites/default/development.settings.php",
      "@symlink-files"
    ],
    "build-production": [
      "@composer install --no-dev --prefer-dist --no-suggest --optimize-autoloader --ignore-platform-reqs --ansi",
      "@copy-configuration",
      "cp conf/production.services.yml public/sites/default/production.services.yml",
      "cp conf/production.settings.php public/sites/default/production.settings.php",
      "@symlink-files"
    ],
    "build-testing": [
      "@composer install --no-dev --prefer-dist --no-suggest --optimize-autoloader --ignore-platform-reqs --ansi",
      "@copy-configuration",
      "cp conf/development.services.yml public/sites/default/development.services.yml",
      "cp conf/development.settings.php public/sites/default/development.settings.php",
      "@symlink-files"
    ],
    "copy-configuration": [
      "chmod 0750 public/sites/default",
      "rm -f public/sites/default/settings.php && cp conf/settings.php public/sites/default/settings.php",
      "cp conf/all.services.yml public/sites/default/all.settings.yml",
      "cp conf/all.settings.php public/sites/default/all.settings.php"
    ],
    "fix": [
      "phpcbf --colors --standard=Drupal --extensions=php,module ./public/modules/custom",
      "phpcbf --colors --standard=Drupal --extensions=php,theme ./public/themes/custom"
    ],
    "reset-local": [
      "reset-local.sh"
    ],
    "symlink-files": [
      "mkdir -m 777 -p files files_private",
      "ln -sfn ../../../files public/sites/default/files"
    ],
    "test": [
      "@test-behavioral",
      "@test-static-js",
      "@test-static-php",
      "@test-unit"
    ],
    "test-behavioral": [
      "tools/behavioral-tests"
    ],
    "test-static-js": [
      "node_modules/eslint/bin/eslint.js --color --ignore-pattern '**/vendor/*' --c ./public/core/.eslintrc.json --global nav,moment,responsiveNav:true ./public/modules/custom/*/js",
      "node_modules/eslint/bin/eslint.js --color --ignore-pattern '**/vendor/*' --c ./public/core/.eslintrc.json --global nav,moment,responsiveNav:true ./public/themes/custom/*/js"
    ],
    "test-static-php": [
      "phpcs --colors --standard=Drupal --extensions=php,module --ignore='*.css,*.md' ./public/modules/custom",
      "phpcs --colors --standard=Drupal --extensions=php,theme --ignore='*.css,*.md' ./public/themes/custom"
    ],
    "test-unit": [
      "phpunit -c phpunit.xml.dist --testsuite unit"
    ],
    "update-deps": [
      "@composer update --with-dependencies --no-scripts --no-suggest --prefer-dist --ignore-platform-reqs --ansi"
    ]
  }
}
